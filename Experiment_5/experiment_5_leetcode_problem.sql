

SELECT MACHINE_ID, 
ROUND(
SUM(CASE WHEN ACTIVITY_TYPE='end' THEN TIMESTAMP ELSE -TIMESTAMP END) /
SUM(CASE WHEN ACTIVITY_TYPE='end' THEN 1 END) , 3) AS PROCESSING_TIME
FROM Activity
GROUP BY MACHINE_ID
ORDER BY MACHINE_ID
